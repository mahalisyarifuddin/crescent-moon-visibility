<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<title>Hilal Visibility Map</title>
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
		<style>
			:root  {
				--primary: #005dac;
				--on-primary: #ffffff;
				--hover: #00539a;
				--background: #f9f9ff;
				--surface: #ffffff;
				--text: #181c21;
				--border: #c1c6d4;
				--muted: #f2f3fc;
				--success: #0b6b1d;
				--on-success: #ffffff;
				--danger: #ba1a1a;
				--on-danger: #ffffff;
				--highlight-bg: #d4e3ff;
			}
			 @media (prefers-color-scheme: dark)  {
				:root:not(.light)  {
					--primary: #a5c8ff;
					--on-primary: #00315f;
					--hover: #72adff;
					--background: #101319;
					--surface: #0b0e14;
					--text: #e0e2ea;
					--border: #414752;
					--muted: #181c21;
					--success: #82db7e;
					--on-success: #00390a;
					--danger: #ffb4ab;
					--on-danger: #93000a;
					--highlight-bg: #001c3a;
				}
			}
			 :root.dark  {
				--primary: #a5c8ff;
				--on-primary: #00315f;
				--hover: #72adff;
				--background: #101319;
				--surface: #0b0e14;
				--text: #e0e2ea;
				--border: #414752;
				--muted: #181c21;
				--success: #82db7e;
				--on-success: #00390a;
				--danger: #ffb4ab;
				--on-danger: #93000a;
				--highlight-bg: #001c3a;
			}
			 *  {
				box-sizing: border-box;
				margin: 0;
				padding: 0;
				outline-offset: 2px;
			}
			 *:focus-visible  {
				outline: 2px solid var(--primary);
			}
			 body  {
				background: var(--background);
				color: var(--text);
				font-family: sans-serif;
				display: flex;
				justify-content: center;
				min-height: 100vh;
				padding: 1rem;
			}
			 .container  {
				background: var(--surface);
				border: 1px solid var(--border);
				border-radius: 8px;
				max-width: 1200px;
				padding: 2rem;
				width: 100%;
				position: relative;
				margin: 2rem 0;
				display: flex;
				flex-direction: column;
			}
			 .hidden  {
				display: none !important;
			}
			 h1, h2, h3, label  {
				margin: .5rem 0;
			}
			 label  {
				display: block;
				font-weight: 700;
			}
			 input, select, button  {
				background: var(--surface);
				border: 1px solid var(--border);
				border-radius: 4px;
				color: var(--text);
				font-size: 1rem;
				padding: .5rem;
				width: 100%;
			}
			 button  {
				cursor: pointer;
			}
			 button:disabled  {
				opacity: .6;
				cursor: not-allowed;
			}
			 .primary  {
				background: var(--primary);
				color: var(--on-primary);
				border: 0;
			}
			 .primary:hover:not(:disabled)  {
				background: var(--hover);
			}
			 .secondary:hover:not(:disabled)  {
				background: var(--muted);
			}
			 .selectors  {
				position: absolute;
				right: 2rem;
				top: 1rem;
				display: flex;
				gap: 8px;
				z-index: 1000;
			}
			 .row  {
				display: flex;
				gap: 1rem;
				margin-bottom: 1rem;
			}
			 .group  {
				flex: 1;
			}
			 .info  {
				font-size: .9rem;
				opacity: .8;
				line-height: 1.6;
			}
			 #map  {
				width: 100%;
				height: 500px;
				border: 1px solid var(--border);
				border-radius: 4px;
				margin-top: 1rem;
			}
			 .tabs  {
				display: flex;
				border-bottom: 1px solid var(--border);
				margin-bottom: 1rem;
			}
			 .tab  {
				background: transparent;
				border: none;
				border-bottom: 3px solid transparent;
				border-radius: 0;
				cursor: pointer;
				padding: 0.5rem 1rem;
				font-weight: 600;
				color: var(--text);
				opacity: 0.6;
				width: auto;
			}
			 .tab:hover  {
				background: var(--muted);
				opacity: 1;
			}
			 .tab.active  {
				border-bottom-color: var(--primary);
				opacity: 1;
			}
			 #results  {
				margin-top: 1rem;
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
				gap: 1rem;
			}
			 .result-card  {
				background: var(--surface);
				padding: 1rem;
				border-radius: 4px;
				border: 1px solid var(--border);
				box-shadow: 0 1px 3px rgba(0,0,0,0.05);
			}
			 .result-label  {
				font-size: 0.8rem;
				opacity: 0.8;
				margin-bottom: 0.25rem;
			}
			 .result-value  {
				font-size: 1.2rem;
				font-weight: bold;
			}
			 @media(max-width: 768px)  {
				.selectors  {
					position: static;
					justify-content: end;
					margin-bottom: .5rem;
				}
				 .row  {
					flex-direction: column;
				}
				 #map  {
					height: 350px;
				}
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="selectors">
				<select id="language">
					<option value="en">English</option>
					<option value="id">Bahasa Indonesia</option>
				</select>
				<select id="theme">
					<option value="auto">Auto</option>
					<option value="light">Light</option>
					<option value="dark">Dark</option>
				</select>
			</div>

			<h1 id="mapTitle">Hilal Visibility Map</h1>

			<div class="tabs">
				<button id="tabMap" class="tab active">Map</button>
				<button id="tabCalc" class="tab">Detailed Calculations</button>
			</div>

			<div id="mapView">
				<div id="controls">
					<div class="row">
					<div class="group">
						<label id="dateLabel" for="mapDate">Date</label>
						<input type="date" id="mapDate">
					</div>
					<div class="group">
						<label id="regionLabel" for="mapRegion">Region</label>
						<select id="mapRegion">
							<option value="indonesia">Indonesia</option>
							<option value="world">World</option>
						</select>
					</div>
					<div class="group">
						<label id="criteriaLabel" for="mapCriteria">Criteria</label>
						<select id="mapCriteria">
							<option value="mabbims">MABBIMS (Alt‚â•3¬∞, Elong‚â•6.4¬∞)</option>
							<option value="gic">Global Islamic (Alt‚â•5¬∞, Elong‚â•8¬∞, <12am UTC)</option>
							<option value="alt0">Altitude > 0¬∞</option>
							<option value="custom">Custom Criteria</option>
						</select>
					</div>
				</div>

				<div class="row hidden" id="customCriteriaInputs">
					<div class="group">
						<label id="minAltLabel" for="minAlt">Min Altitude (¬∞)</label>
						<input type="number" id="minAlt" value="0" step="0.1">
					</div>
					<div class="group">
						<label id="minElongLabel" for="minElong">Min Elongation (¬∞)</label>
						<input type="number" id="minElong" value="0" step="0.1">
					</div>
				</div>

				<div class="row">
					<button id="renderMap" class="primary">Render Map</button>
				</div>
			</div>

			<div id="mapStatus" class="info" style="font-style:italic; min-height: 1.2em;"></div>
			<div id="map"></div>

			<div id="mapLegend" class="info" style="margin-top:0.5rem">
				<span style="display:inline-block;width:12px;height:12px;background:rgba(0, 255, 0, 0.5);margin-right:4px;border:1px solid green"></span><span id="legendVisible">Visible</span>
			</div>
			</div>

			<div id="calcView" class="hidden">
				<div class="row">
					<div class="group">
						<label id="calcDateLabel" for="calcDate">Date</label>
						<input type="date" id="calcDate">
					</div>
					<div class="group">
						<label id="calcLatLabel" for="calcLat">Latitude</label>
						<input type="number" id="calcLat" step="0.0001" placeholder="-6.2000">
					</div>
					<div class="group">
						<label id="calcLonLabel" for="calcLon">Longitude</label>
						<input type="number" id="calcLon" step="0.0001" placeholder="106.8166">
					</div>
					<div class="group">
						<label id="utcOffsetLabel" for="calcUtcOffset">UTC Offset</label>
						<input type="number" id="calcUtcOffset" step="0.5" value="0" placeholder="e.g. 7">
				</div>
				</div>
				<div class="row">
					<div class="group">
						<label id="calcCriteriaLabel" for="calcCriteria">Criteria</label>
						<select id="calcCriteria">
							<option value="mabbims">MABBIMS</option>
							<option value="gic">Global Islamic</option>
							<option value="alt0">Altitude > 0¬∞</option>
							<option value="custom">Custom</option>
						</select>
					</div>
					<div class="group">
						<button id="getLocation" class="secondary" style="margin-top: 1.7rem;">üìç Use My Location</button>
					</div>
				</div>

				<div class="row hidden" id="calcCustomCriteriaInputs">
					<div class="group">
						<label for="calcMinAlt">Min Altitude (¬∞)</label>
						<input type="number" id="calcMinAlt" value="0" step="0.1">
					</div>
					<div class="group">
						<label for="calcMinElong">Min Elongation (¬∞)</label>
						<input type="number" id="calcMinElong" value="0" step="0.1">
					</div>
				</div>

				<div class="row">
					<button id="calculateBtn" class="primary">Calculate</button>
				</div>

				<div id="results"></div>
			</div>

		</div>

		<script src="https://cdn.jsdelivr.net/npm/astronomy-engine@2.1.19/astronomy.browser.min.js"></script>
		<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

		<script src="script.js"></script>
	</body>
</html>
